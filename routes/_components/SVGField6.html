<svg width="{$x * cx}" height="{$y * cy * 2}">
  <defs>
    <polygon id="hexagon" points="{hexagon}" stroke-opacity="0.2" stroke="#efefef" />
    <g id="circle">
      <circle r="{$size * 2}" fill="black" opacity="1" />
      <circle r="{$size * 86.66 / 2}" fill="skyblue" opacity="0.8" />
    </g>
  </defs>
  <g transform="matrix(1.35,0,0,1.35,0,0)">
    <rect width="{$x * 86.66 * 2}" height="{$y * 100 * 2}" fill="#efefef" /> {#each field as f, i}
    <g transform="matrix(1,0,0,1,{f.x * 75 * $size},{f.y * 86.66 * $size})">
      <!-- <use
        href="#circle"
        x="{50 * $size}"
        y="{(f.x % 2 === 1) ? 56.66 * $size : 100 * $size}"
      /> -->
      <use
        href="#hexagon"
        fill="{cellstate($statecolors, f.v)}"
        x="{0}"
        y="{(f.x % 2 === 1) ? 6.66 * $size : 50 * $size}"
        on:click="click({x: f.x, y: f.y})"
        opacity="0.7" />
    </g>
    {/each}
  </g>
</svg>

<style>
  svg {
    width: 100%;
    height: 500px;
    border: 1px solid white;
  }
</style>

<script>
  import { hexagonal } from '../../modules'

  const { scale } = hexagonal

  export default {
    data() {
      return {
        field: [],
        hexagon: scale(),
      }
    },
    computed: {
      hexagon: ({ $size }) => scale($size)
    },
    methods: {
      click: function ({ x, y }) { console.log(x, y) }
    },
    helpers: {
      cellstate: (colors, n) => n < colors.length ? colors[n] : colors[0]
    },
  }
</script>

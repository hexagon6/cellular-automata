<button on:click="generateField({ x: $x, y: $y, initializer: (n, i) => (n % i), field: [] })">initialize empty field</button>

<CA id={id} name={name} field={field} type={algorithm.name} />

<script>
  import CA from './CA.html';
  import { GameofLifeDefault, hexagonal, rectangular } from '../../modules'

  const [x, y] = [8, 8]
  const field = []

  const fieldGen = type => {
    const _default = 'rectangular'
    const generators = {
      'hexagonal': hexagonal.field,
      'rectangular': rectangular.field,
    }
    return (type in generators) ? generators[type] : generators[_default]
  }
  export default {
    oncreate() {
      console.log('init GameofLife')
      const { fieldtype, statecolors, stati } = GameofLifeDefault
      this.store.set({
        fieldtype,
        statecolors,
        stati,
        x,
        y,
      })
    },
    data() {
      return Object.assign({
        x,
        y,
        field
      }, GameofLifeDefault)
    },
    methods: {
      generateField: function ({ x, y, initializer, field }) {
        const { statecolors: { length: states }, fieldtype } = this.store.get()
        const f = fieldGen(fieldtype)(x, y, states, initializer)
        this.set({ field: f })
      }
    },
    components: {
      CA,
    }
  }
</script>
